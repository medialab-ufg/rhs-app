<ion-header id="shrinkHeader">

  <ion-navbar color="secondary">
    <ion-title><img alt="RHS" height="36" src="./assets/logo-rhs.svg"/></ion-title>
    <ion-buttons end>
      <button ion-button icon-only (click)="openShareActionSheet()">
        <ion-icon name="share"></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>

</ion-header>

<ion-content padding fullscreen shrink-header="12px">

  <div *ngIf="isLoadingPost"><ion-spinner></ion-spinner></div>
  <div *ngIf="!isLoadingPost">

    <!-- POST TITLE -->
    <h1 [innerHTML]="post.title['rendered']"></h1>

    <!-- POST CATEGORIES -->
    <div *ngIf="isLoadingCategories"><ion-spinner></ion-spinner></div>
    <div *ngIf="!isLoadingCategories && categories.length > 0">
      <ion-buttons>
        <button ion-button round small clear *ngFor="let category of categories">{{ category.name }}</button>
      </ion-buttons>
    </div>

    <!-- POST CONTENT -->
    <div [innerHTML]="post.content['rendered']"></div>
    
    <!-- POST AUTHOR-->
    <div *ngIf="isLoadingAuthor"><ion-spinner></ion-spinner></div>
    <div *ngIf="!isLoadingAuthor">
      <h2>{{ author.name }}</h2>
      <ion-avatar item-start>
        <img src="{{ author.avatar_urls[48] }}">
      </ion-avatar>
    </div>
    <h4>Publicado em {{ post.date }}</h4>

    <!-- POST TAGS -->
    <div *ngIf="isLoadingTags"><ion-spinner></ion-spinner></div>
    <div *ngIf="!isLoadingTags && tags.length > 0">
      <h3>Tags ({{ tags.length }})</h3>
      <ion-buttons>
        <button ion-button round small outline *ngFor="let tag of tags">{{ tag.name }}</button>
      </ion-buttons>
    </div>

    <!-- POST ACTION BUTTONS-->
    <ion-buttons>
      <button ion-button (click)="commentPost()">Comentar</button>
      <button ion-button (click)="votePost()">Votar</button>
      <button ion-button (click)="openShareActionSheet()">Compartilhar</button>
    </ion-buttons>

    <!-- POST COMMENTS -->
    <div *ngIf="isLoadingComments"><ion-spinner></ion-spinner></div>
    <div *ngIf="!isLoadingComments">
      <h3>{{ comments.length }} comentários.</h3>
      <ion-list>
        <ion-item *ngFor="let comment of comments">
          <ion-avatar item-start>
            <img src="{{ comment.author_avatar_urls[24] }}">
          </ion-avatar>
          <h2>{{ comment.author_name }}</h2>
          <p [innerHtml]="comment.content['rendered']"></p>
          <button ion-button clear icon-only item-end (click)="commentOnComment()">
            <ion-icon name="redo"></ion-icon>
          </button>
        </ion-item>
      </ion-list>
    </div>
  </div>

</ion-content>

<ion-footer *ngIf="this.api.isLogged()">
  <ion-toolbar>
    <ion-input type="text" value="" placeholder="Digite aqui seu comentário."></ion-input>
    <ion-buttons end>
      <button ion-button icon-only (click)="sendMessage()">
        <ion-icon name="send"></ion-icon>
      </button>
    </ion-buttons> 
  </ion-toolbar>
</ion-footer>
